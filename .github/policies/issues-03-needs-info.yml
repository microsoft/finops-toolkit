id: issues-03-needs-info
name: GitOps.PullRequestIssueManagement
description: Handles when an issue needs information
owner:
resource: repository
disabled: false
where:

# spell-checker:disable
configuration:
  resourceManagementConfiguration:
    eventResponderTasks:
      - description: >-
          When an issue has been triaged with `#needs-info` in a comment:
          - Assign to author
          - Remove the `Needs: Triage ğŸ”` label
          - Label with `Needs: Attention`
        if:
          - payloadType: Issue_Comment
          - isOpen
          - commentContains:
              pattern: '#needs-info'
          - or:
              - activitySenderHasPermission:
                  permission: Admin
              - activitySenderHasPermission:
                  permission: Write
        then:
          - addLabel:
              label: 'Needs: Attention ğŸ‘‹'
          - removeLabel:
              label: 'Needs: Triage ğŸ”'
          - assignTo:
              author: True
      - description: >-
          When an issue needs info/attn, remove triage label:
          - Assign to author
          - Remove the `Needs: Information` label
          - Remove the `Needs: Attention ğŸ‘‹` label
          - Label with `Needs: Triage ğŸ”`
        if:
          - or:
              - payloadType: Issues
              - payloadType: Issue_Comment
          - or:
              - labelAdded:
                  label: 'Needs: Information'
              - labelAdded:
                  label: 'Needs: Attention ğŸ‘‹'
          - hasLabel:
              label: 'Needs: Triage ğŸ”'
          - isOpen
        then:
          - removeLabel:
              label: 'Needs: Triage ğŸ”'
          - assignTo:
              author: True
      - description: >-
          When an issue that needs info/attn has been responded to:
          - Remove author assignee
          - Remove the `Needs: Information` label
          - Remove the `Needs: Attention ğŸ‘‹` label
          - Label with `Needs: Triage ğŸ”`
        if:
          - or:
              - payloadType: Issues
              - payloadType: Issue_Comment
          - or:
              - hasLabel:
                  label: 'Needs: Information'
              - hasLabel:
                  label: 'Needs: Attention ğŸ‘‹'
          - isOpen
          - isActivitySender:
              issueAuthor: True
        then:
          - removeLabel:
              label: 'Needs: Attention ğŸ‘‹'
          - removeLabel:
              label: 'Needs: Information'
          - addLabel:
              label: 'Needs: Triage ğŸ”'
          - assignTo:
              author: False
onFailure:
onSuccess:
