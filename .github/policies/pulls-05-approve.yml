id: pulls-05-approve
name: GitOps.PullRequestIssueManagement
description: Handles when PR is approved
owner:
resource: repository
disabled: false
where:

# spell-checker:disable
configuration:
  resourceManagementConfiguration:
    eventResponderTasks:
      - description: >-
          When PR is approved:
          - Assign to author
          - Label with `Status: â–¶ï¸ Ready`
          - Remove `Needs: Attention ğŸ‘‹` label
        if:
          - payloadType: Pull_Request_Review
          - isAction:
              action: Submitted
          - isReviewState:
              reviewState: Approved
          - isActivitySender:
              issueAuthor: False
          - not:
              targetsBranch:
                branch: main
        then:
          - addLabel:
              label: 'Status: â–¶ï¸ Ready'
          - removeLabel:
              label: 'Needs: Review ğŸ‘€'
          - removeLabel:
              label: 'Needs: Attention ğŸ‘‹'
          - assignTo:
              author: True
          - if:
              - isActivitySender:
                  user: flanakin
              - titleContains:
                  pattern: '^add [^ ]+ as a contributor for [a-z]+$'
            then:
              - enableAutoMerge:
                  mergeMethod: squash
onFailure:
onSuccess:
