---
title: Remove-FinOpsTestData command
description: Remove test data from a FinOps hub environment using the Remove-FinOpsTestData command in the FinOpsToolkit module.
author: fallenhoot
ms.author: josholan
ms.date: 02/21/2026
ms.topic: reference
ms.service: finops
ms.subservice: finops-toolkit
ms.reviewer: micflan
#customer intent: As a FinOps practitioner, I want to clean up test data from my FinOps hub to reset the environment.
---

<!-- markdownlint-disable-next-line MD025 -->

# Remove-FinOpsTestData command

The **Remove-FinOpsTestData** command purges test data generated by [New-FinOpsTestData](New-FinOpsTestData.md) from Azure Data Explorer, Azure Storage, and the local test-data folder. By default only the local folder is cleaned. Pass `-StorageAccountName` and/or `-AdxClusterUri` to also clean cloud resources.

> [!NOTE]
> This command does not manage Microsoft Fabric Real-Time Intelligence data. If your hub uses Fabric, clean up Fabric data separately. Test data generated by `New-FinOpsTestData` is compatible with both ADX and Fabric ingestion paths.

### Safety features

This command includes multiple safety layers to prevent accidentally deleting production data:

- **Local-only by default** – When called without cloud parameters, only the local `test-data` folder is deleted.
- **Targeted storage deletion** – The command scans every manifest in the `msexports` and `ingestion` containers for the `_ftkTestData` watermark written by `New-FinOpsTestData`. Only folders whose manifest contains the marker are deleted, so production data in the same storage account is preserved. If no markers are found, deletion is refused. Use `-Force` to wipe all blobs.
- **ADX requires `-Force`** – Because `.clear table` removes **all** data (production and test), the command refuses to run ADX cleanup unless `-Force` is specified. There is no way to selectively delete test rows from ADX.

> [!IMPORTANT]
> Do not ingest test data into an Azure Data Explorer cluster that also contains production data. Unlike storage (where only test-data folders are deleted), ADX `.clear table` removes **every row**. If you accidentally mix test and production data in ADX, clear the tables and re-ingest production data from storage. Production exports in storage are preserved by the targeted deletion. For Microsoft Fabric, clean up data directly in your Fabric workspace — this command does not modify Fabric resources.

Steps performed:

1. **Stop ADF triggers** (optional) – Prevents re-ingestion during cleanup.
2. **Purge ADX tables** (requires `-Force`) – Clears all tables in the Hub and Ingestion databases via the ADX REST API.
3. **Verify update policies** – Ensures ADX update policies are still intact after clearing tables.
4. **Delete test-data folders from storage** – Removes only blob folders whose manifest contains the `_ftkTestData` marker. Production data is preserved.
5. **Delete local files** – Removes the local test-data directory.

> [!WARNING]
> This command permanently deletes data. It uses `ConfirmImpact = 'High'`, so you will be prompted for confirmation before any data is removed. Use `-Confirm:$false` to skip the prompt.

<br>

## Syntax

```powershell
Remove-FinOpsTestData `
    [-AdxClusterUri <string>] `
    [-StorageAccountName <string>] `
    [-AdfName <string>] `
    [-ResourceGroupName <string>] `
    [-StopTriggers] `
    [-Force] `
    [-OutputPath <string>]
```

<br>

## Parameters

| Name                  | Description                                                                                                                                                                                                                                                               |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `‑AdxClusterUri`      | Optional. Azure Data Explorer cluster URI. Requires `-Force` because `.clear table` removes all data (production and test). Example: `https://finopsdemoadx4uj6pm.italynorth.kusto.windows.net`.                                                                          |
| `‑StorageAccountName` | Optional. Azure Storage account name for blob cleanup. The command scans every manifest for the `_ftkTestData` marker and deletes only the folders that contain marked manifests. Production data is preserved. Use `-Force` to wipe all blobs when no markers are found. |
| `‑AdfName`            | Optional. Azure Data Factory name. Required when using `-StopTriggers`.                                                                                                                                                                                                   |
| `‑ResourceGroupName`  | Optional. Resource group containing the ADF instance. Required when using `-StopTriggers`.                                                                                                                                                                                |
| `‑StopTriggers`       | Optional. Stop ADF triggers before cleanup to prevent re-ingestion during the purge.                                                                                                                                                                                      |
| `‑Force`              | Optional. Bypass safety checks. Required for ADX cleanup (clears all rows). For storage, causes a full container wipe when no `_ftkTestData` markers are found.                                                                                                           |
| `‑OutputPath`         | Optional. Local directory to delete. Default = `./test-data`.                                                                                                                                                                                                             |

<br>

## Prerequisites

- PowerShell 7.0 or later
- [Az.Accounts](https://www.powershellgallery.com/packages/Az.Accounts) module (required for ADX token acquisition)
- [Az.Storage](https://www.powershellgallery.com/packages/Az.Storage) module (required for blob cleanup)
- [Az.DataFactory](https://www.powershellgallery.com/packages/Az.DataFactory) module (required for `-StopTriggers`)
- Authenticated Azure session (`Connect-AzAccount`)

<br>

## Examples

### Local-only cleanup

```powershell
Remove-FinOpsTestData
```

Deletes the local `./test-data` folder only. No cloud resources are touched.

### Storage cleanup with marker verification

```powershell
Remove-FinOpsTestData `
    -StorageAccountName "stfinopsdemo4uj6pmwee34z"
```

Scans storage for manifests with the `_ftkTestData` marker, then deletes blobs if markers are found. Also deletes the local test-data directory.

### Full cleanup with -Force

```powershell
Remove-FinOpsTestData `
    -AdxClusterUri "https://finopsdemoadx4uj6pm.italynorth.kusto.windows.net" `
    -StorageAccountName "stfinopsdemo4uj6pmwee34z" `
    -AdfName "adf-finopsdemo-4uj6pm" `
    -ResourceGroupName "rg-finopshub-demo" `
    -StopTriggers `
    -Force
```

Stops ADF triggers, clears all ADX tables, deletes all storage blobs, and removes local files. `-Force` is required for ADX cleanup and skips marker verification for storage.

<br>

## Give feedback

Let us know how we're doing with a quick review. We use these reviews to improve and expand FinOps tools and resources.

> [!div class="nextstepaction"]
> [Give feedback](https://portal.azure.com/#view/HubsExtension/InProductFeedbackBlade/extensionName/FinOpsToolkit/cesQuestion/How%20easy%20or%20hard%20is%20it%20to%20use%20the%20FinOps%20toolkit%20PowerShell%20module%3F/cvaQuestion/How%20valuable%20are%20the%20FinOps%20toolkit%20PowerShell%20module%3F/surveyId/FTK/bladeName/PowerShell/featureName/TestData.RemoveFinOpsTestData)

If you're looking for something specific, vote for an existing or create a new idea. Share ideas with others to get more votes. We focus on ideas with the most votes.

> [!div class="nextstepaction"]
> [Vote on or suggest ideas](https://github.com/microsoft/finops-toolkit/issues?q=is%3Aissue%20is%3Aopen%20label%3A%22Tool%3A%20PowerShell%22%20sort%3A"reactions-%2B1-desc")

<br>

## Related content

Related commands:

- [New-FinOpsTestData](New-FinOpsTestData.md) – Generate synthetic, multi-cloud FOCUS-compliant cost data.

Related solutions:

- [FinOps hubs](../../hubs/finops-hubs-overview.md)
- [FinOps toolkit Power BI reports](../../power-bi/reports.md)

<br>
