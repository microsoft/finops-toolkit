# Query Index


## Base Queries

These base queries are used extensively in the FinOps Toolkit.  Ensure you include these base queries in your KQL when using queries from the query library.

| Variable Name      | Query ID                                 | KQL File Link                                                                 | Description                                      |
|--------------------|------------------------------------------|-------------------------------------------------------------------------------|--------------------------------------------------|
| CostsThisMonth     | 43612ae4-c475-4f22-bb50-ce9d995abb8f     | [43612ae4-c475-4f22-bb50-ce9d995abb8f.kql](43612ae4-c475-4f22-bb50-ce9d995abb8f.kql)     | Aggregates cost data for the current month        |
| CostsLastMonth     | cb1f5404-c0b1-42fd-99fb-3cff7b08daaa     | [cb1f5404-c0b1-42fd-99fb-3cff7b08daaa.kql](cb1f5404-c0b1-42fd-99fb-3cff7b08daaa.kql)     | Aggregates cost data for the last closed month    |
| CostsByMonth       | 4ce0f587-2d45-436c-8f79-102c6b382439     | [4ce0f587-2d45-436c-8f79-102c6b382439.kql](4ce0f587-2d45-436c-8f79-102c6b382439.kql)     | Aggregates cost data by month                     |
| CostsByDay         | 6b598467-8c31-4693-b1eb-7ed683fcfc3a     | [6b598467-8c31-4693-b1eb-7ed683fcfc3a.kql](6b598467-8c31-4693-b1eb-7ed683fcfc3a.kql)     | Aggregates cost data by day                       |
| CostsByDayAHB      | 4a1973bf-08e9-4e82-b8e6-6edff81cf0a5     | [4a1973bf-08e9-4e82-b8e6-6edff81cf0a5.kql](4a1973bf-08e9-4e82-b8e6-6edff81cf0a5.kql)     | Aggregates cost data by day for AHB resources     |
| CostsPlus          | eb9259cc-05b7-4441-a66d-a29026fe371b     | [eb9259cc-05b7-4441-a66d-a29026fe371b.kql](eb9259cc-05b7-4441-a66d-a29026fe371b.kql)     | Lists available time ranges for reporting         |

## Query Library


This section summarizes the main queries used in the FinOps Toolkit.  Ensure you include the base queries in your KQL.


For more details, see the [FinOps Toolkit Power BI Cost Summary documentation](https://github.com/basicmachines-co/finops-toolkit/blob/main/docs-mslearn/toolkit/power-bi/cost-summary.md).

| Query | Query ID | Description | Used Variables |
|-------|----------|-------------|---------------|
| Validates data quality for cost records by month. | [`0341b3e4-eccc-4924-9555-9835b128c543`](0341b3e4-eccc-4924-9555-9835b128c543.kql) | Validates data quality for cost records by month. | [`CostsByMonth`](#base-queries) |
| Shows cost trends over time, including percent change from previous month. | [`0d91ea4a-c81d-4a21-b708-b6af37be1eec`](0d91ea4a-c81d-4a21-b708-b6af37be1eec.kql) | Shows cost trends over time, including percent change from previous month. | [`CostsByMonth`](#base-queries) |
| Pivoted effective cost by month and region, including totals. Useful for regional cost analysis and benchmarking. | [`0dcf2c54-7f1d-45e9-a53b-d598a24493a4`](0dcf2c54-7f1d-45e9-a53b-d598a24493a4.kql) | Pivoted effective cost by month and region, including totals. Useful for regional cost analysis and benchmarking. | [`CostsByMonth`](#base-queries) |
| Shows data completeness by dimension, grouping minor categories as "others". | [`13813a00-e634-4428-9eac-ea255fd1eaca`](13813a00-e634-4428-9eac-ea255fd1eaca.kql) | Shows data completeness by dimension, grouping minor categories as "others". | [`CostsByDay`](#base-queries), [`maxGroupCount`](#base-queries) |
| Calculates commitment discount coverage as a percentage of total cost. | [`13cad52d-91e7-4ab4-aad5-4aae21c1019a`](13cad52d-91e7-4ab4-aad5-4aae21c1019a.kql) | Calculates commitment discount coverage as a percentage of total cost. | [`CostsByMonth`](#base-queries) |
| Compares billed vs. effective costs for last month, formatted for visualization by month. | [`152f2041-bbc1-41e4-b155-271b2e0cf6e9`](152f2041-bbc1-41e4-b155-271b2e0cf6e9.kql) | Compares billed vs. effective costs for last month, formatted for visualization by month. | [`CostsLastMonth`](#base-queries) |
| Forecasts budget for future months. | [`1d273b55-d2ea-427c-8a5f-01f6c240e98a`](1d273b55-d2ea-427c-8a5f-01f6c240e98a.kql) | Forecasts budget for future months. | [`CostsByMonth`](#base-queries) |
| Cost breakdown by resource type for each month, grouping minor types as "others". Useful for visualizing top resource types and aggregating the rest. | [`21a87abe-19e2-44ec-8298-ba872e66c162`](21a87abe-19e2-44ec-8298-ba872e66c162.kql) | Cost breakdown by resource type for each month, grouping minor types as "others". Useful for visualizing top resource types and aggregating the rest. | [`CostsByMonth`](#base-queries), [`maxGroupCount`](#base-queries) |
| Cost breakdown by service name for each month, grouping minor services as "others". Useful for visualizing top services and aggregating the rest. | [`30644718-defd-4c6c-9ffa-a9c2cd1f871f`](30644718-defd-4c6c-9ffa-a9c2cd1f871f.kql) | Cost breakdown by service name for each month, grouping minor services as "others". Useful for visualizing top services and aggregating the rest. | [`CostsByMonth`](#base-queries), [`maxGroupCount`](#base-queries) |
| Summarizes software license utilization by month. | [`35a3a2b3-4ab0-4449-96f7-c78db789089e`](35a3a2b3-4ab0-4449-96f7-c78db789089e.kql) | Summarizes software license utilization by month. | [`CostsByMonth`](#base-queries) |
| Analyzes reservation usage and savings by month. | [`377e3693-0738-45d7-97d9-4b6e71ec5b36`](377e3693-0738-45d7-97d9-4b6e71ec5b36.kql) | Analyzes reservation usage and savings by month. | [`CostsByMonth`](#base-queries) |
| Pivoted effective cost by month and sub-account, including totals. Useful for comparing sub-account costs across months and in aggregate. | [`3886b5cd-34a8-42d7-9e16-33ea4d236953`](3886b5cd-34a8-42d7-9e16-33ea4d236953.kql) | Pivoted effective cost by month and sub-account, including totals. Useful for comparing sub-account costs across months and in aggregate. | [`CostsByMonth`](#base-queries) |
| Cost breakdown by service category for each month, grouping minor categories as "others". Useful for visualizing top service categories and aggregating the rest. | [`3924981c-23e4-464d-a872-045df1752750`](3924981c-23e4-464d-a872-045df1752750.kql) | Cost breakdown by service category for each month, grouping minor categories as "others". Useful for visualizing top service categories and aggregating the rest. | [`CostsByMonth`](#base-queries), [`maxGroupCount`](#base-queries) |
| Checks resource metadata consistency by month. | [`3b3f0a58-2d84-4e3e-bebc-3e747a7d5ede`](3b3f0a58-2d84-4e3e-bebc-3e747a7d5ede.kql) | Checks resource metadata consistency by month. | [`CostsByMonth`](#base-queries) |
| Provides showback reporting by distributing costs to consumers, grouping minor categories as "others". | [`49e24ee0-91de-4b1c-973f-036a3c060aca`](49e24ee0-91de-4b1c-973f-036a3c060aca.kql) | Provides showback reporting by distributing costs to consumers, grouping minor categories as "others". | [`CostsByDay`](#base-queries), [`maxGroupCount`](#base-queries) |
| Tracks service category budget by month, grouping minor categories as "others". | [`4c7a7614-9b8c-415b-a4e1-d2d53c023d31`](4c7a7614-9b8c-415b-a4e1-d2d53c023d31.kql) | Tracks service category budget by month, grouping minor categories as "others". | [`CostsByMonth`](#base-queries), [`maxGroupCount`](#base-queries) |
| Provides data model diagnostics for the hub. | [`56fd8707-bbb3-4f7e-8e37-8dd90ada3baa`](56fd8707-bbb3-4f7e-8e37-8dd90ada3baa.kql) | Provides data model diagnostics for the hub. | None |
| Calculates savings from commitment discounts by comparing effective and contracted costs. | [`5bbb5369-ac95-45fc-853c-a6a2ce6a9e7b`](5bbb5369-ac95-45fc-853c-a6a2ce6a9e7b.kql) | Calculates savings from commitment discounts by comparing effective and contracted costs. | [`CostsByMonth`](#base-queries) |
| Cost breakdown by resource group for each month, grouping minor groups as "others". Useful for visualizing top resource groups and aggregating the rest. | [`61b26784-6a73-4e80-85b2-9c5cfbd2dd06`](61b26784-6a73-4e80-85b2-9c5cfbd2dd06.kql) | Cost breakdown by resource group for each month, grouping minor groups as "others". Useful for visualizing top resource groups and aggregating the rest. | [`CostsByMonth`](#base-queries), [`maxGroupCount`](#base-queries) |
| Pivoted effective cost by month, service name, and service category, including totals. Useful for multidimensional cost analysis. | [`6259f773-593c-4953-898c-15aa5ff6e53a`](6259f773-593c-4953-898c-15aa5ff6e53a.kql) | Pivoted effective cost by month, service name, and service category, including totals. Useful for multidimensional cost analysis. | [`CostsByMonth`](#base-queries) |
| Identifies license optimization opportunities by month. | [`62bbceee-c089-45db-822c-0b4745358aa4`](62bbceee-c089-45db-822c-0b4745358aa4.kql) | Identifies license optimization opportunities by month. | [`CostsByMonth`](#base-queries) |
| Analyzes SaaS spending by month. | [`7d0c2c1f-338b-4534-b173-36b284779131`](7d0c2c1f-338b-4534-b173-36b284779131.kql) | Analyzes SaaS spending by month. | [`CostsByMonth`](#base-queries) |
| Calculates chargeback allocation by distributing costs to business units or cost centers. | [`7f7b08a9-ae15-46f8-8b0f-767280375add`](7f7b08a9-ae15-46f8-8b0f-767280375add.kql) | Calculates chargeback allocation by distributing costs to business units or cost centers. | [`CostsByMonth`](#base-queries) |
| Monitors resource naming compliance by day. | [`84ecad69-79ac-45b9-a8af-60be28dcc748`](84ecad69-79ac-45b9-a8af-60be28dcc748.kql) | Monitors resource naming compliance by day. | [`CostsByDay`](#base-queries) |
| Retrieves hub settings and configuration. | [`8de47213-8327-44da-9d1b-8ba5de74c44a`](8de47213-8327-44da-9d1b-8ba5de74c44a.kql) | Retrieves hub settings and configuration. | None |
| Pivoted effective cost by month and sub-account, including totals. Useful for business value metrics and unit economics. | [`90502e9a-2d0d-4ae4-8d9d-cc21f9b72d5d`](90502e9a-2d0d-4ae4-8d9d-cc21f9b72d5d.kql) | Pivoted effective cost by month and sub-account, including totals. Useful for business value metrics and unit economics. | [`CostsByMonth`](#base-queries) |
| Shows total commitment discount purchases by month. | [`98c9b9b5-bebf-41f8-8319-5fa2523f9dd0`](98c9b9b5-bebf-41f8-8319-5fa2523f9dd0.kql) | Shows total commitment discount purchases by month. | [`CostsByMonth`](#base-queries) |
| Reconciles invoice amounts with daily costs, grouping minor categories as "others". | [`9c5d3cf0-b6cb-45a2-acfd-b19df425bddf`](9c5d3cf0-b6cb-45a2-acfd-b19df425bddf.kql) | Reconciles invoice amounts with daily costs, grouping minor categories as "others". | [`CostsByDay`](#base-queries), [`maxGroupCount`](#base-queries) |
| Summarizes billed and effective costs by month for timechart visualization. | [`bc24e050-f2b9-4b4a-a08d-69fc4a4bb95e`](bc24e050-f2b9-4b4a-a08d-69fc4a4bb95e.kql) | Summarizes billed and effective costs by month for timechart visualization. | [`CostsByMonth`](#base-queries) |
| Pivoted effective cost by month, sub-account, and resource group, including totals. Useful for cost allocation and business unit reporting. | [`c2c65ec0-e57d-4834-8a6b-b5975afeb9a0`](c2c65ec0-e57d-4834-8a6b-b5975afeb9a0.kql) | Pivoted effective cost by month, sub-account, and resource group, including totals. Useful for cost allocation and business unit reporting. | [`CostsByMonth`](#base-queries) |
| Compares budget vs. actual spending by month. | [`c7be613e-deb4-4779-ad75-4445e8d5e01f`](c7be613e-deb4-4779-ad75-4445e8d5e01f.kql) | Compares budget vs. actual spending by month. | [`CostsByMonth`](#base-queries) |
| Tracks data quality trends by day. | [`cb34f22b-9370-460c-9658-3e73d220bbc7`](cb34f22b-9370-460c-9658-3e73d220bbc7.kql) | Tracks data quality trends by day. | [`CostsByDay`](#base-queries) |
| Cost breakdown by region for each month, grouping minor regions as "others". Useful for visualizing top regions and aggregating the rest. | [`d5224d06-c8e7-4dd9-afec-595b39712f5a`](d5224d06-c8e7-4dd9-afec-595b39712f5a.kql) | Cost breakdown by region for each month, grouping minor regions as "others". Useful for visualizing top regions and aggregating the rest. | [`CostsByMonth`](#base-queries), [`maxGroupCount`](#base-queries) |
| Distributes costs by charge categories for each month, grouping minor categories as "others". | [`d7a9ff96-da17-4826-9fb5-b23f4c7b938d`](d7a9ff96-da17-4826-9fb5-b23f4c7b938d.kql) | Distributes costs by charge categories for each month, grouping minor categories as "others". | [`CostsByMonth`](#base-queries), [`maxGroupCount`](#base-queries) |
| Calculates FinOps maturity metrics by day. | [`d7f31381-ba44-46a1-ad3e-dc6b8826706d`](d7f31381-ba44-46a1-ad3e-dc6b8826706d.kql) | Calculates FinOps maturity metrics by day. | [`CostsByDay`](#base-queries) |
| Identifies missing tags by day. | [`dcf69b47-233e-4bc4-b914-3f6f09f4cb82`](dcf69b47-233e-4bc4-b914-3f6f09f4cb82.kql) | Identifies missing tags by day. | [`CostsByDay`](#base-queries) |
| Monitors tag compliance by month. | [`e17346d1-0227-4aa4-8765-f9b4bf43bed5`](e17346d1-0227-4aa4-8765-f9b4bf43bed5.kql) | Monitors tag compliance by month. | [`CostsByMonth`](#base-queries) |
| Shows SaaS usage patterns by month. | [`e1bc2d51-44af-4dd9-8b0d-a71088b551f5`](e1bc2d51-44af-4dd9-8b0d-a71088b551f5.kql) | Shows SaaS usage patterns by month. | [`CostsByMonth`](#base-queries) |
| Lists available time ranges for reporting. | [`eb9259cc-05b7-4441-a66d-a29026fe371b`](eb9259cc-05b7-4441-a66d-a29026fe371b.kql) | Lists available time ranges for reporting. | [`numberOfMonths`](#base-queries) |
| Shows daily budget pacing, grouping minor categories as "others". | [`ebe41e27-e9f9-478e-ab90-fd1f87906766`](ebe41e27-e9f9-478e-ab90-fd1f87906766.kql) | Shows daily budget pacing, grouping minor categories as "others". | [`CostsByDay`](#base-queries), [`maxGroupCount`](#base-queries) |
| Calculates governance policy metrics by day. | [`f1ef29df-7a1d-4dd0-8619-0c0164707b31`](f1ef29df-7a1d-4dd0-8619-0c0164707b31.kql) | Calculates governance policy metrics by day. | [`CostsByDay`](#base-queries) |
| Counts subscriptions, resource groups, resources, and services for last month. | [`f2cecbb0-13f8-4642-afa4-bbcc0558f777`](f2cecbb0-13f8-4642-afa4-bbcc0558f777.kql) | Counts subscriptions, resource groups, resources, and services for last month. | [`CostsLastMonth`](#base-queries) |
