# FinOps Hub Query Catalog

> **Note:** Refer to the [FinOps Hub Database Documentation](./finops-hub-database-guide.md) for table and column definitions.

> **Tip:** If you do not find a more specific or suitable query for your analysis, start with the [`costs-enriched-base`](./catalog/costs-enriched-base.kql) query. It provides the full enrichment and savings logic for all cost columns and is the recommended foundation for custom analytics and reporting.

---

## Query-to-Scenario Matrix: Find the Right Query for Your FinOps Task

| Common FinOps Task / Scenario                                                                 | Recommended Query Name/ID                        | Description / When to Use                                                                                 | How to Use |
|----------------------------------------------------------------------------------------------|--------------------------------------------------|----------------------------------------------------------------------------------------------------------|------------|
| View all available cost and enrichment columns for custom analysis                            | [costs-enriched-base](./catalog/costs-enriched-base.kql)                              | Use as a foundation for any custom analytics or reporting.                                               | Set `startDate`/`endDate` to define analysis period; use as foundation for custom reports aligned with "Understand Cloud Usage & Cost" domain. |
| Analyze monthly cost trends (e.g., for CIO/leadership reporting)                             | [monthly-cost-trend](./catalog/monthly-cost-trend.kql)                               | Track total billed and effective cost by month for trend analysis and executive reporting.                | Set `startDate`/`endDate` for trend period; supports "Reporting and Analytics" capability for executive dashboards. |
| Identify top cost-driving resource groups                                                    | [top-resource-groups-by-cost](./catalog/top-resource-groups-by-cost.kql)                      | Find which resource groups are responsible for the most spend in a given period.                         | Adjust `N` parameter (default: 5) for result count; set `startDate`/`endDate` for specific analysis periods. |
| Report quarterly cost by resource group                                                      | [quarterly-cost-by-resource-group](./catalog/quarterly-cost-by-resource-group.kql)                  | Summarize effective cost by resource group for quarterly or multi-month reporting.                       | Set `startDate`/`endDate` for fiscal quarters; adjust `N` parameter (default: 5) for top resource groups shown. |
| Analyze cost by region for optimization                                                      | [cost-by-region-trend](./catalog/cost-by-region-trend.kql)                             | Break down effective cost by Azure region to identify regional cost drivers.                             | Set `startDate`/`endDate` for analysis period; supports "Workload Optimization" capability for region selection. |
| Identify top resource types by cost and usage                                                | [top-resource-types-by-cost](./catalog/top-resource-types-by-cost.kql)                       | See which resource types (VMs, storage, etc.) are most used and most expensive.                          | Set `N` parameter (default: 10) for result count; set `startDate`/`endDate` for specific period analysis. |
| Identify top services by cost                                                                | [top-services-by-cost](./catalog/top-services-by-cost.kql)                             | Find which Azure services (e.g., SQL, App Service) are driving the most cost.                            | Set `N` parameter (default: 10) for result count; set `startDate`/`endDate` for analysis period; key for cost visibility. |
| Allocate cost by financial hierarchy (Billing Profile, Invoice Section, Team, Product, App)  | [cost-by-financial-hierarchy](./catalog/cost-by-financial-hierarchy.kql)                      | For detailed allocation and showback/chargeback reporting.                                               | Set `N` parameter (default: 5) for top results; set `startDate`/`endDate`; supports "Allocation" capability in FinOps framework. |
| Benchmark service prices and savings (list, contracted, effective, negotiated, commitment)   | [service-price-benchmarking](./catalog/service-price-benchmarking.kql)                       | Compare prices and savings by service for benchmarking and procurement.                                  | Set `startDate`/`endDate` for benchmark period; supports "Benchmarking" capability in "Quantify Business Value" domain. |
| Forecast future cloud spend                                                                  | [cost-forecasting-model](./catalog/cost-forecasting-model.kql)                           | Project future costs for budgeting and planning.                                                         | Set `startDate`/`endDate` for historical data; adjust `forecastPeriods` (default: 90) and `interval` (default: 1d) for forecast horizon. |
| Detect cost anomalies and spikes                                                             | [cost-anomaly-detection](./catalog/cost-anomaly-detection.kql)                           | Identify unusual cost spikes or drops for investigation.                                                 | Set `numberOfMonths` (default: 12) for lookback period; adjust `interval` (default: 1d) for detection granularity. |
| Calculate month-over-month cost change percentage                                            | [monthly-cost-change-percentage](./catalog/monthly-cost-change-percentage.kql)                   | Monitor cost volatility and trend direction.                                                             | Set `startDate`/`endDate` for analysis period; results show percent changes for both billed and effective costs. |
| Analyze commitment discount (RI/SP) utilization                                              | [commitment-discount-utilization](./catalog/commitment-discount-utilization.kql)                  | See how much of your usage is covered by reservations or savings plans.                                  | Set `startDate`/`endDate` for analysis period; supports "Rate Optimization" capability in FinOps framework. |
| Summarize negotiated, commitment, and total savings (Effective Savings Rate)                 | [savings-summary-report](./catalog/savings-summary-report.kql)                           | Get a summary of all realized savings and your effective savings rate.                                   | Set `startDate`/`endDate` for reporting period; calculates total savings and Effective Savings Rate (ESR) KPI. |
| List top commitment (RI/SP) transactions                                                     | [top-commitment-transactions](./catalog/top-commitment-transactions.kql)                      | Identify the largest reservation or savings plan purchases and their impact.                             | Set `N` parameter (default: 10) for result count; set `startDate`/`endDate` to analyze specific purchase periods. |
| List top other (non-commitment, non-usage) transactions                                      | [top-other-transactions](./catalog/top-other-transactions.kql)                           | Analyze large purchases not covered by RI/SP (e.g., support, marketplace, etc.).                        | Set `N` parameter (default: 10) for result count; set `startDate`/`endDate` to analyze non-usage spend. |
| Analyze reservation recommendations and break-even points                                   | [reservation-recommendation-breakdown](./catalog/reservation-recommendation-breakdown.kql)             | Review Microsoft recommendations for new reservations and their projected savings.                       | Run without parameters for all recommendations; filter by service or region for targeted optimization. |

> **Tip:** For any scenario not listed, start with [costs-enriched-base](./catalog/costs-enriched-base.kql) and customize as needed.

---

## References

- [FinOps Framework (Microsoft Learn)](https://learn.microsoft.com/en-us/cloud-computing/finops/framework/finops-framework)
- [Implementing FinOps Guide (Microsoft Learn)](https://learn.microsoft.com/en-us/cloud-computing/finops/implementing-finops-guide)
- [Adopt FinOps on Azure (Microsoft Learn)](https://learn.microsoft.com/en-us/training/modules/adopt-finops-on-azure/)
- [FinOps Hub Database Documentation](./finops-hub-database-guide.md)
- [FinOps Foundation](https://www.finops.org/framework/)
