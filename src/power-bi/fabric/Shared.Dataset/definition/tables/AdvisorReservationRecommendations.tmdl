table AdvisorReservationRecommendations
	lineageTag: e2be3b74-1430-4a74-bf1a-18576064c803

	column id
		dataType: string
		lineageTag: e9cd6688-9a32-4da4-86e9-aed15b22652d
		summarizeBy: none
		sourceColumn: id

		annotation SummarizationSetBy = Automatic

	column name
		dataType: string
		lineageTag: 8eb22dcc-76d0-4491-9aa3-d264bcc05789
		summarizeBy: none
		sourceColumn: name

		annotation SummarizationSetBy = Automatic

	column type
		dataType: string
		lineageTag: 6f67e3de-1718-458f-84e2-704ada614a9c
		summarizeBy: none
		sourceColumn: type

		annotation SummarizationSetBy = Automatic

	column tenantId
		dataType: string
		lineageTag: e234753b-df26-4bad-9de1-a06cee5c9c33
		summarizeBy: none
		sourceColumn: tenantId

		annotation SummarizationSetBy = Automatic

	column kind
		dataType: string
		lineageTag: 534bd722-dd95-4aad-92d8-bc8529546ff5
		summarizeBy: none
		sourceColumn: kind

		annotation SummarizationSetBy = Automatic

	column location
		dataType: string
		lineageTag: 09df61d7-3eec-4971-aa97-d3489f18c68c
		summarizeBy: none
		sourceColumn: location

		annotation SummarizationSetBy = Automatic

	column resourceGroup
		dataType: string
		lineageTag: 83b30238-1681-410f-8d99-ffa3cccc1cc1
		summarizeBy: none
		sourceColumn: resourceGroup

		annotation SummarizationSetBy = Automatic

	column subscriptionId
		dataType: string
		lineageTag: 16bdbe5d-b58a-4f14-8467-ebac36aa3ba0
		summarizeBy: none
		sourceColumn: subscriptionId

		annotation SummarizationSetBy = Automatic

	column managedBy
		dataType: string
		lineageTag: c466ebc3-989d-4b83-8588-8b94c8c4ff54
		summarizeBy: none
		sourceColumn: managedBy

		annotation SummarizationSetBy = Automatic

	column sku
		dataType: string
		lineageTag: 010e18a7-cf07-452c-97d6-f42a7cc11e5c
		summarizeBy: none
		sourceColumn: sku

		annotation SummarizationSetBy = Automatic

	column plan
		dataType: string
		lineageTag: e5699310-6f0b-4a68-bd99-979ee7bdfeac
		summarizeBy: none
		sourceColumn: plan

		annotation SummarizationSetBy = Automatic

	column 'properties.recommendationTypeId'
		dataType: string
		lineageTag: badf977b-e853-4e53-a169-64a2dd84d1dd
		summarizeBy: none
		sourceColumn: properties.recommendationTypeId

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.reservedResourceType'
		dataType: string
		lineageTag: 865a01a5-6c7e-4669-9b20-19133445405f
		summarizeBy: none
		sourceColumn: properties.extendedProperties.reservedResourceType

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.annualSavingsAmount'
		dataType: double
		lineageTag: 09d4b890-7c8d-4ee0-943d-4a9212c7091f
		summarizeBy: sum
		sourceColumn: properties.extendedProperties.annualSavingsAmount

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'properties.extendedProperties.targetResourceCount'
		dataType: int64
		formatString: 0
		lineageTag: f2f67512-e38d-410d-a77a-1a530a905a36
		summarizeBy: sum
		sourceColumn: properties.extendedProperties.targetResourceCount

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.savingsCurrency'
		dataType: string
		lineageTag: 26882091-cceb-4825-8f25-e57c49d2353e
		summarizeBy: none
		sourceColumn: properties.extendedProperties.savingsCurrency

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.lookbackPeriod'
		dataType: string
		lineageTag: 82a3a6d5-01c1-4db7-be17-572b62ceb699
		summarizeBy: none
		sourceColumn: properties.extendedProperties.lookbackPeriod

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.savingsAmount'
		dataType: double
		lineageTag: 99312e80-1a6c-4520-a5b0-645f69d8e310
		summarizeBy: sum
		sourceColumn: properties.extendedProperties.savingsAmount

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'properties.extendedProperties.displaySKU'
		dataType: string
		lineageTag: 20289648-2bc4-4c25-b1b0-826abefd04cb
		summarizeBy: none
		sourceColumn: properties.extendedProperties.displaySKU

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.displayQty'
		dataType: int64
		formatString: 0
		lineageTag: 886d306c-f180-4676-8cd0-5ec56d7feb04
		summarizeBy: sum
		sourceColumn: properties.extendedProperties.displayQty

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.location'
		dataType: string
		lineageTag: 42e5826c-0b31-4819-b7e0-319ecea32fea
		summarizeBy: none
		sourceColumn: properties.extendedProperties.location

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.region'
		dataType: string
		lineageTag: c6c5edcb-3e8f-464c-86a0-bb54b943e817
		summarizeBy: none
		sourceColumn: properties.extendedProperties.region

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.vmSize'
		dataType: string
		lineageTag: 8fed315f-01e6-4b99-8881-931664de1eae
		summarizeBy: none
		sourceColumn: properties.extendedProperties.vmSize

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.subId'
		dataType: string
		lineageTag: dbbb8676-ac50-4761-bbd4-3b570710c2f4
		summarizeBy: none
		sourceColumn: properties.extendedProperties.subId

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.scope'
		dataType: string
		lineageTag: a1352eea-bc3b-468c-a288-178d8cdb770f
		summarizeBy: none
		sourceColumn: properties.extendedProperties.scope

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.term'
		dataType: string
		lineageTag: 60bc379d-ff92-4d80-89c0-e20addb02ae7
		summarizeBy: none
		sourceColumn: properties.extendedProperties.term

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.sku'
		dataType: string
		lineageTag: 9754b4be-44c4-46ed-b53a-0cd3c0d3b32c
		summarizeBy: none
		sourceColumn: properties.extendedProperties.sku

		annotation SummarizationSetBy = Automatic

	column 'properties.extendedProperties.qty'
		dataType: int64
		formatString: 0
		lineageTag: b5c62ce1-3aa8-4e8f-bf60-91b160868d92
		summarizeBy: sum
		sourceColumn: properties.extendedProperties.qty

		annotation SummarizationSetBy = Automatic

	column 'properties.resourceMetadata.resourceId'
		dataType: string
		lineageTag: c1a5553c-a8e2-44b6-a4e2-ee173b5b88ff
		summarizeBy: none
		sourceColumn: properties.resourceMetadata.resourceId

		annotation SummarizationSetBy = Automatic

	column 'properties.resourceMetadata.singular'
		dataType: string
		lineageTag: aadd862e-b506-4ae6-849a-8a83c0744c65
		summarizeBy: none
		sourceColumn: properties.resourceMetadata.singular

		annotation SummarizationSetBy = Automatic

	column 'properties.resourceMetadata.plural'
		dataType: string
		lineageTag: 3973f04a-8d35-415e-b06e-4ec8dbfe9048
		summarizeBy: none
		sourceColumn: properties.resourceMetadata.plural

		annotation SummarizationSetBy = Automatic

	column 'properties.resourceMetadata.action'
		dataType: string
		lineageTag: 8c8a5ac4-e51d-4fa2-a031-0cb29c29db82
		summarizeBy: none
		sourceColumn: properties.resourceMetadata.action

		annotation SummarizationSetBy = Automatic

	column 'properties.resourceMetadata.source'
		dataType: string
		lineageTag: 4cb277aa-3319-4aaa-8c6a-a49e9a4a11ab
		summarizeBy: none
		sourceColumn: properties.resourceMetadata.source

		annotation SummarizationSetBy = Automatic

	column 'properties.shortDescription.solution'
		dataType: string
		lineageTag: 98412b8a-854a-4292-a30c-8e096ce4c728
		summarizeBy: none
		sourceColumn: properties.shortDescription.solution

		annotation SummarizationSetBy = Automatic

	column 'properties.shortDescription.problem'
		dataType: string
		lineageTag: e31a4cd0-a5f9-4a5f-bea6-ecff0be2ea13
		summarizeBy: none
		sourceColumn: properties.shortDescription.problem

		annotation SummarizationSetBy = Automatic

	column 'properties.suppressionIds'
		dataType: string
		lineageTag: aa582a0d-0c5f-49dd-93f2-3363bb02828c
		summarizeBy: none
		sourceColumn: properties.suppressionIds

		annotation SummarizationSetBy = Automatic

	column 'properties.impactedField'
		dataType: string
		lineageTag: c0947fb9-3d13-4cad-a274-bb58dc488100
		summarizeBy: none
		sourceColumn: properties.impactedField

		annotation SummarizationSetBy = Automatic

	column 'properties.impactedValue'
		dataType: string
		lineageTag: d803c460-7f91-4c6e-9649-a28d90b8f2a2
		summarizeBy: none
		sourceColumn: properties.impactedValue

		annotation SummarizationSetBy = Automatic

	column 'properties.lastUpdated'
		dataType: dateTime
		formatString: General Date
		lineageTag: b93e22ab-02ec-4821-aff7-4a45b86fee21
		summarizeBy: none
		sourceColumn: properties.lastUpdated

		annotation SummarizationSetBy = Automatic

	column 'properties.metadata'
		dataType: string
		lineageTag: 055caf5c-5b7b-428a-b4a1-0b4c68ca55b9
		summarizeBy: none
		sourceColumn: properties.metadata

		annotation SummarizationSetBy = Automatic

	column 'properties.category'
		dataType: string
		lineageTag: 0bdec23f-098b-486d-870d-3df3e3fb737c
		summarizeBy: none
		sourceColumn: properties.category

		annotation SummarizationSetBy = Automatic

	column 'properties.impact'
		dataType: string
		lineageTag: a6596380-928f-4559-a334-26c33b67c4a9
		summarizeBy: none
		sourceColumn: properties.impact

		annotation SummarizationSetBy = Automatic

	column tags
		dataType: string
		lineageTag: b16b5afb-c413-4ff0-ab8c-6c6600861a21
		summarizeBy: none
		sourceColumn: tags

		annotation SummarizationSetBy = Automatic

	column identity
		dataType: string
		lineageTag: 88c80752-1903-4373-8066-70bdf23003f4
		summarizeBy: none
		sourceColumn: identity

		annotation SummarizationSetBy = Automatic

	column zones
		dataType: string
		lineageTag: 0331483a-6206-4584-9900-4236aab8bc93
		summarizeBy: none
		sourceColumn: zones

		annotation SummarizationSetBy = Automatic

	column extendedLocation
		dataType: string
		lineageTag: 58d3f314-0458-4b2b-a447-fc15b23e5b02
		summarizeBy: none
		sourceColumn: extendedLocation

		annotation SummarizationSetBy = Automatic

	column recommendedActions
		dataType: string
		lineageTag: e7e9e023-cf8c-4c71-b652-4481af19b173
		summarizeBy: none
		sourceColumn: recommendedActions

		annotation SummarizationSetBy = Automatic

	partition AdvisorReservationRecommendations = m
		mode: import
		queryGroup: 'Resource Graph'
		source =
				let
				  Source = AzureResourceGraph.Query("
				    advisorresources
				    | where type == 'microsoft.advisor/recommendations'
				    | where properties['category'] == 'Cost'
				    | where properties['shortDescription']['solution'] == 'Consider virtual machine reserved instance to save over your on-demand costs'
				  " & ftk_DemoFilter(), "Tenant", null, null, [resultTruncated = true]),
				  #"Expanded properties 1" = Table.ExpandRecordColumn(Source, "properties", {"recommendationTypeId", "extendedProperties", "resourceMetadata", "shortDescription", "suppressionIds", "impactedField", "impactedValue", "lastUpdated", "metadata", "category", "impact"}, {"properties.recommendationTypeId", "properties.extendedProperties", "properties.resourceMetadata", "properties.shortDescription", "properties.suppressionIds", "properties.impactedField", "properties.impactedValue", "properties.lastUpdated", "properties.metadata", "properties.category", "properties.impact"}),
				  #"Expanded properties.shortDescription 1" = Table.ExpandRecordColumn(#"Expanded properties 1", "properties.shortDescription", {"solution", "problem"}, {"properties.shortDescription.solution", "properties.shortDescription.problem"}),
				  #"Expanded properties.extendedProperties" = Table.ExpandRecordColumn(#"Expanded properties.shortDescription 1", "properties.extendedProperties", {"reservedResourceType", "annualSavingsAmount", "targetResourceCount", "savingsCurrency", "lookbackPeriod", "savingsAmount", "displaySKU", "displayQty", "location", "region", "vmSize", "subId", "scope", "term", "sku", "qty"}, {"properties.extendedProperties.reservedResourceType", "properties.extendedProperties.annualSavingsAmount", "properties.extendedProperties.targetResourceCount", "properties.extendedProperties.savingsCurrency", "properties.extendedProperties.lookbackPeriod", "properties.extendedProperties.savingsAmount", "properties.extendedProperties.displaySKU", "properties.extendedProperties.displayQty", "properties.extendedProperties.location", "properties.extendedProperties.region", "properties.extendedProperties.vmSize", "properties.extendedProperties.subId", "properties.extendedProperties.scope", "properties.extendedProperties.term", "properties.extendedProperties.sku", "properties.extendedProperties.qty"}),
				  #"Expanded properties.resourceMetadata" = Table.ExpandRecordColumn(#"Expanded properties.extendedProperties", "properties.resourceMetadata", {"resourceId", "singular", "plural", "action", "source"}, {"properties.resourceMetadata.resourceId", "properties.resourceMetadata.singular", "properties.resourceMetadata.plural", "properties.resourceMetadata.action", "properties.resourceMetadata.source"}),
				  #"Changed column type 2" = Table.TransformColumnTypes(#"Expanded properties.resourceMetadata", {{"properties.extendedProperties.annualSavingsAmount", type number}}, "en-US"),
				  #"Replaced errors" = Table.ReplaceErrorValues(#"Changed column type 2", {{"properties.extendedProperties.annualSavingsAmount", null}}),
				  #"Changed column type 1" = Table.TransformColumnTypes(#"Replaced errors", {{"properties.extendedProperties.savingsAmount", type number}}, "en-US"),
				  #"Replaced errors 1" = Table.ReplaceErrorValues(#"Changed column type 1", {{"properties.extendedProperties.savingsAmount", null}}),
				  #"Replaced value" = Table.ReplaceValue(#"Replaced errors 1", null, 0, Replacer.ReplaceValue, {"properties.extendedProperties.savingsAmount"}),
				  #"Replaced value 1" = Table.ReplaceValue(#"Replaced value", null, 0, Replacer.ReplaceValue, {"properties.extendedProperties.annualSavingsAmount"}),
				  #"Changed column type" = Table.TransformColumnTypes(#"Replaced value 1", {{"properties.lastUpdated", type datetimezone}}),
				  #"Added custom" = Table.TransformColumnTypes(Table.AddColumn(#"Changed column type", "recommendedActions", each [properties.extendedProperties.displaySKU] & " virtual machines in " & [properties.extendedProperties.location]), {{"recommendedActions", type text}}),
				  #"Changed column type 3" = Table.TransformColumnTypes(#"Added custom", {{"properties.extendedProperties.targetResourceCount", Int64.Type}, {"properties.extendedProperties.displayQty", Int64.Type}, {"properties.extendedProperties.qty", Int64.Type}})
				in
				  #"Changed column type 3"

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

