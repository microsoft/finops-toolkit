table ManagementGroups
	lineageTag: 0e04ab5f-9838-4180-a7f3-dc1cbcb6f296

	column id
		dataType: string
		lineageTag: 38577e5e-de2d-4ca7-a7bf-0bd1d7760f70
		summarizeBy: none
		sourceColumn: id

		annotation SummarizationSetBy = Automatic

	column name
		dataType: string
		lineageTag: 0fd21169-a00f-4900-9617-2b610fd5aeeb
		summarizeBy: none
		sourceColumn: name

		annotation SummarizationSetBy = Automatic

	column type
		dataType: string
		lineageTag: 7caac691-f03c-426f-a945-13fac8d416eb
		summarizeBy: none
		sourceColumn: type

		annotation SummarizationSetBy = Automatic

	column tenantId
		dataType: string
		lineageTag: 41a1123e-155c-48a8-ae42-be5c2f9a8d39
		summarizeBy: none
		sourceColumn: tenantId

		annotation SummarizationSetBy = Automatic

	column kind
		dataType: string
		lineageTag: fdcebd93-8ecc-42c1-ad50-b8a9545c2ff4
		summarizeBy: none
		sourceColumn: kind

		annotation SummarizationSetBy = Automatic

	column location
		dataType: string
		lineageTag: bd352c53-fffc-45b9-9042-ddac5d8cb7b1
		summarizeBy: none
		sourceColumn: location

		annotation SummarizationSetBy = Automatic

	column resourceGroup
		dataType: string
		lineageTag: 32c2cdd3-8cfb-467f-b932-bd860cdf5454
		summarizeBy: none
		sourceColumn: resourceGroup

		annotation SummarizationSetBy = Automatic

	column subscriptionId
		dataType: string
		lineageTag: 95c5f3c2-0cf9-40e6-93bf-70c46e61ee16
		summarizeBy: none
		sourceColumn: subscriptionId

		annotation SummarizationSetBy = Automatic

	column managedBy
		dataType: string
		lineageTag: b7f98133-e7a2-4b5c-80b3-f07c76116251
		summarizeBy: none
		sourceColumn: managedBy

		annotation SummarizationSetBy = Automatic

	column sku
		dataType: string
		lineageTag: 8a230b5a-d863-43b3-a713-31badfce6796
		summarizeBy: none
		sourceColumn: sku

		annotation SummarizationSetBy = Automatic

	column plan
		dataType: string
		lineageTag: c405bc3b-7b6b-45c4-93e4-06f0d3eda278
		summarizeBy: none
		sourceColumn: plan

		annotation SummarizationSetBy = Automatic

	column tags
		dataType: string
		lineageTag: 9084e19a-6639-447c-b365-671cd2e81486
		summarizeBy: none
		sourceColumn: tags

		annotation SummarizationSetBy = Automatic

	column identity
		dataType: string
		lineageTag: 5ffd94bb-922a-4e28-a475-b818e035a90f
		summarizeBy: none
		sourceColumn: identity

		annotation SummarizationSetBy = Automatic

	column zones
		dataType: string
		lineageTag: 843d2718-8d1a-41a2-be04-8010408f4f84
		summarizeBy: none
		sourceColumn: zones

		annotation SummarizationSetBy = Automatic

	column extendedLocation
		dataType: string
		lineageTag: 1536d8ca-3e8b-492f-9ebd-1760fcda0656
		summarizeBy: none
		sourceColumn: extendedLocation

		annotation SummarizationSetBy = Automatic

	column properties
		dataType: string
		lineageTag: 3b170688-85ae-4e9d-890e-7e5661c505d0
		summarizeBy: none
		sourceColumn: properties

		annotation SummarizationSetBy = Automatic

	column 'properties.displayName'
		dataType: string
		lineageTag: c2a83af4-ecb0-48e2-8c91-c539f010c832
		summarizeBy: none
		sourceColumn: properties.displayName

		annotation SummarizationSetBy = Automatic

	column 'properties.details'
		dataType: string
		lineageTag: 22995768-4815-4e93-8dbd-380eb7d44f43
		summarizeBy: none
		sourceColumn: properties.details

		annotation SummarizationSetBy = Automatic

	column 'properties.details.managementGroupAncestorsChain'
		dataType: string
		lineageTag: d19480fb-6f16-49e7-b2b7-4fad83c35e7d
		summarizeBy: none
		sourceColumn: properties.details.managementGroupAncestorsChain

		annotation SummarizationSetBy = Automatic

	column 'properties.details.updatedTime'
		dataType: string
		lineageTag: 008e6ba3-287b-47b4-a4ab-739a14ac19fa
		summarizeBy: none
		sourceColumn: properties.details.updatedTime

		annotation SummarizationSetBy = Automatic

	column 'properties.details.updatedBy'
		dataType: string
		lineageTag: 7ba4276d-ba03-4243-b330-9b2961829e82
		summarizeBy: none
		sourceColumn: properties.details.updatedBy

		annotation SummarizationSetBy = Automatic

	column 'properties.details.version'
		dataType: string
		lineageTag: cc74e405-4d3e-4c8f-b35f-2dd4d388b1d4
		summarizeBy: none
		sourceColumn: properties.details.version

		annotation SummarizationSetBy = Automatic

	column 'properties.details.parent'
		dataType: string
		lineageTag: 107025bb-de26-4e8b-8c2a-64c244d292d8
		summarizeBy: none
		sourceColumn: properties.details.parent

		annotation SummarizationSetBy = Automatic

	column 'properties.details.parent.displayName'
		dataType: string
		lineageTag: b160c643-8416-4ffd-a945-3c0119eafadb
		summarizeBy: none
		sourceColumn: properties.details.parent.displayName

		annotation SummarizationSetBy = Automatic

	column 'properties.details.parent.name'
		dataType: string
		lineageTag: e5cbe777-4e50-4c62-aec7-67ead1fe0b8d
		summarizeBy: none
		sourceColumn: properties.details.parent.name

		annotation SummarizationSetBy = Automatic

	column 'properties.details.parent.id'
		dataType: string
		lineageTag: 42790a1e-b547-4fdb-808f-8c49218e9530
		summarizeBy: none
		sourceColumn: properties.details.parent.id

		annotation SummarizationSetBy = Automatic

	column 'properties.details.managementGroupAncestorsChain.displayName'
		dataType: string
		lineageTag: 4ca64703-7f49-4170-93f3-16087702156f
		summarizeBy: none
		sourceColumn: properties.details.managementGroupAncestorsChain.displayName

		annotation SummarizationSetBy = Automatic

	column 'properties.details.managementGroupAncestorsChain.name'
		dataType: string
		lineageTag: f5aa191d-ef68-4b44-92f7-63bdca6bc16c
		summarizeBy: none
		sourceColumn: properties.details.managementGroupAncestorsChain.name

		annotation SummarizationSetBy = Automatic

	partition ManagementGroups = m
		mode: import
		queryGroup: 'Resource Graph'
		source =
				let
				  query = "
				    resourcecontainers
				    | where type == 'microsoft.management/managementgroups'
				    | extend
				      ['properties.displayName'] = properties.displayName,
				      ['properties.details'] = properties.details,
				      ['properties.details.managementGroupAncestorsChain'] = properties.details.managementGroupAncestorsChain,
				      ['properties.details.updatedTime'] = properties.details.updatedTime,
				      ['properties.details.updatedBy'] = properties.details.updatedBy,
				      ['properties.details.version'] = properties.details.version,
				      ['properties.details.parent'] = properties.details.parent,
				      ['properties.details.parent.displayName'] = properties.details.parent.displayName,
				      ['properties.details.parent.name'] = properties.details.parent.name,
				      ['properties.details.parent.id'] = properties.details.parent.id
				    | mv-expand ['properties.details.managementGroupAncestorsChain']
				    | extend
				      ['properties.details.managementGroupAncestorsChain.displayName'] = properties.details.managementGroupAncestorsChain.displayName,
				      ['properties.details.managementGroupAncestorsChain.name'] = properties.details.managementGroupAncestorsChain.name
				    " & (if ftk_DemoFilter() = "" then "" else "| where name startswith 'Trey'"),
				  Source = AzureResourceGraph.Query(query, "Tenant", null, null, [resultTruncated = false]),
				  NullHandling =
				    if Table.HasColumns(Source, "Results") and Table.RowCount(Source) = 1 then
							#table(
								{ "id", "name", "properties.displayName", "properties.details", "properties.details.managementGroupAncestorsChain", "properties.details.updatedTime", "properties.details.updatedBy", "properties.details.version", "properties.details.parent", "properties.details.parent.displayName", "properties.details.parent.name", "properties.details.parent.id", "properties.details.managementGroupAncestorsChain.displayName", "properties.details.managementGroupAncestorsChain.name" },
								{}
							)
				    else Source
				in
				  NullHandling

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

