table NetworkInterfaces
	lineageTag: 471a2007-5388-404a-97e6-1b2292878a8c

	column id
		dataType: string
		lineageTag: 350304ea-658e-45c9-b91f-9a5c4e9e4e5e
		summarizeBy: none
		sourceColumn: id

		annotation SummarizationSetBy = Automatic

	column name
		dataType: string
		lineageTag: 4de0f771-a5db-454d-8359-25ac021b7c34
		summarizeBy: none
		sourceColumn: name

		annotation SummarizationSetBy = Automatic

	column type
		dataType: string
		lineageTag: 30277976-2075-47bf-88d6-316004a703ef
		summarizeBy: none
		sourceColumn: type

		annotation SummarizationSetBy = Automatic

	column tenantId
		dataType: string
		lineageTag: e19c378f-5a30-4891-94a5-9433d5063a05
		summarizeBy: none
		sourceColumn: tenantId

		annotation SummarizationSetBy = Automatic

	column kind
		dataType: string
		lineageTag: 129a13b3-51f2-4efa-92ac-83ec9da54ac3
		summarizeBy: none
		sourceColumn: kind

		annotation SummarizationSetBy = Automatic

	column location
		dataType: string
		lineageTag: 859d2a47-f779-4202-8342-d4e9868d8577
		summarizeBy: none
		sourceColumn: location

		annotation SummarizationSetBy = Automatic

	column resourceGroup
		dataType: string
		lineageTag: 87326b2b-3574-4489-a376-efb4a97c6f1c
		summarizeBy: none
		sourceColumn: resourceGroup

		annotation SummarizationSetBy = Automatic

	column subscriptionId
		dataType: string
		lineageTag: 33e52a92-a847-4919-a23a-4c93a0932e1c
		summarizeBy: none
		sourceColumn: subscriptionId

		annotation SummarizationSetBy = Automatic

	column managedBy
		dataType: string
		lineageTag: dd7f082f-7e83-4270-af76-194e5c1feb8e
		summarizeBy: none
		sourceColumn: managedBy

		annotation SummarizationSetBy = Automatic

	column sku
		dataType: string
		lineageTag: 3e15e566-bff8-4a36-91ec-e506030024ec
		summarizeBy: none
		sourceColumn: sku

		annotation SummarizationSetBy = Automatic

	column plan
		dataType: string
		lineageTag: 7627e490-3357-4dd3-9c87-dd788bba3447
		summarizeBy: none
		sourceColumn: plan

		annotation SummarizationSetBy = Automatic

	column 'properties.provisioningState'
		dataType: string
		lineageTag: a914b230-a579-49f5-8d62-30f53d413472
		summarizeBy: none
		sourceColumn: properties.provisioningState

		annotation SummarizationSetBy = Automatic

	column 'properties.resourceGuid'
		dataType: string
		lineageTag: f45d5cde-7c8c-4569-912f-9c5e231564d8
		summarizeBy: none
		sourceColumn: properties.resourceGuid

		annotation SummarizationSetBy = Automatic

	column 'properties.enableAcceleratedNetworking'
		dataType: string
		lineageTag: a1b2c147-76f7-4804-8957-16d7f697ff99
		summarizeBy: none
		sourceColumn: properties.enableAcceleratedNetworking

		annotation SummarizationSetBy = Automatic

	column 'properties.disableTcpStateTracking'
		dataType: string
		lineageTag: b5d561af-b683-4af3-87fc-f7566cc5f8f9
		summarizeBy: none
		sourceColumn: properties.disableTcpStateTracking

		annotation SummarizationSetBy = Automatic

	column 'properties.vnetEncryptionSupported'
		dataType: string
		lineageTag: 415ce3bd-0646-4e4a-b38a-fc9a45800ef9
		summarizeBy: none
		sourceColumn: properties.vnetEncryptionSupported

		annotation SummarizationSetBy = Automatic

	column 'properties.networkSecurityGroup.id'
		dataType: string
		lineageTag: 54e23578-a933-447d-a1db-f96c9089063d
		summarizeBy: none
		sourceColumn: properties.networkSecurityGroup.id

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.type'
		dataType: string
		lineageTag: 414395a3-c718-4bc4-ac73-606db3b02953
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.type

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.name'
		dataType: string
		lineageTag: 9dce3e2f-9097-4437-a16e-d5f79f3d75a9
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.name

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.provisioningState'
		dataType: string
		lineageTag: 59df08a7-16e3-4ae1-9ceb-8b0370af6dbd
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.provisioningState

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.privateIPAddressVersion'
		dataType: string
		lineageTag: 73c9a30f-9d7d-40f3-b25c-469ba0479e72
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.privateIPAddressVersion

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.privateIPAllocationMethod'
		dataType: string
		lineageTag: b76aad6e-6023-4164-8a57-a70456ed9f03
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.privateIPAllocationMethod

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.subnet'
		dataType: string
		lineageTag: 80ef1a4a-cf6e-48fc-afc4-181e61360d1d
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.subnet

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.privateIPAddress'
		dataType: string
		lineageTag: 8c504c90-132f-4223-a0ad-a4348a5ee790
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.privateIPAddress

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.primary'
		dataType: string
		lineageTag: a9cbfce3-bbdf-4db6-bbb1-d16afbc57117
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.primary

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.publicIPAddress.id'
		dataType: string
		lineageTag: 26bdae49-b2c1-4acc-908b-6bc01631c134
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.publicIPAddress.id

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.id'
		dataType: string
		lineageTag: 3c77c9cd-7a20-43f1-ad5f-4f57755e0f79
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.id

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.etag'
		dataType: string
		lineageTag: 95127943-55d6-4d40-9386-2bde61c45455
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.etag

		annotation SummarizationSetBy = Automatic

	column 'properties.enableIPForwarding'
		dataType: string
		lineageTag: 8c870b92-2431-48ed-a4e3-8adc3977625a
		summarizeBy: none
		sourceColumn: properties.enableIPForwarding

		annotation SummarizationSetBy = Automatic

	column 'properties.tapConfigurations'
		dataType: string
		lineageTag: 23417d1a-820a-4832-94a8-fa7097c30863
		summarizeBy: none
		sourceColumn: properties.tapConfigurations

		annotation SummarizationSetBy = Automatic

	column 'properties.hostedWorkloads'
		dataType: string
		lineageTag: 69ad895c-4bb9-4f98-8da3-6c0b8a00d4f0
		summarizeBy: none
		sourceColumn: properties.hostedWorkloads

		annotation SummarizationSetBy = Automatic

	column 'properties.allowPort25Out'
		dataType: string
		lineageTag: e9b92dd1-0da9-4db1-82db-1437b06af481
		summarizeBy: none
		sourceColumn: properties.allowPort25Out

		annotation SummarizationSetBy = Automatic

	column 'properties.auxiliaryMode'
		dataType: string
		lineageTag: b3a8fb34-de86-48b2-bcc2-4602912fa4ac
		summarizeBy: none
		sourceColumn: properties.auxiliaryMode

		annotation SummarizationSetBy = Automatic

	column 'properties.dnsSettings'
		dataType: string
		lineageTag: 02f4ca50-b2c4-4c58-9349-dbc5f64cff51
		summarizeBy: none
		sourceColumn: properties.dnsSettings

		annotation SummarizationSetBy = Automatic

	column 'properties.auxiliarySku'
		dataType: string
		lineageTag: 2b2a9e20-1b30-47e7-b827-de2d05b60924
		summarizeBy: none
		sourceColumn: properties.auxiliarySku

		annotation SummarizationSetBy = Automatic

	column 'properties.macAddress'
		dataType: string
		lineageTag: ad7b0e74-c32a-46be-9b70-707bfc821aa1
		summarizeBy: none
		sourceColumn: properties.macAddress

		annotation SummarizationSetBy = Automatic

	column 'properties.nicType'
		dataType: string
		lineageTag: b80d3831-5768-43c2-96a8-b9c7e02cb784
		summarizeBy: none
		sourceColumn: properties.nicType

		annotation SummarizationSetBy = Automatic

	column 'properties.primary'
		dataType: string
		lineageTag: 17232334-69c8-41d2-8f26-2c29dbba06a3
		summarizeBy: none
		sourceColumn: properties.primary

		annotation SummarizationSetBy = Automatic

	column 'properties.virtualMachine.id'
		dataType: string
		lineageTag: 04875637-be0f-43c8-8cef-9c1acc492ffc
		summarizeBy: none
		sourceColumn: properties.virtualMachine.id

		annotation SummarizationSetBy = Automatic

	column tags
		dataType: string
		lineageTag: cc6805a2-9531-49b5-96ed-35f7c18cc7ee
		summarizeBy: none
		sourceColumn: tags

		annotation SummarizationSetBy = Automatic

	column identity
		dataType: string
		lineageTag: 6d99fdf1-5301-4413-b799-668280d8e5b1
		summarizeBy: none
		sourceColumn: identity

		annotation SummarizationSetBy = Automatic

	column zones
		dataType: string
		lineageTag: f6053c64-a2a2-432f-a449-8838e8b587ac
		summarizeBy: none
		sourceColumn: zones

		annotation SummarizationSetBy = Automatic

	column extendedLocation
		dataType: string
		lineageTag: ad7aa309-2b05-442e-b919-32029e0770ff
		summarizeBy: none
		sourceColumn: extendedLocation

		annotation SummarizationSetBy = Automatic

	column properties
		dataType: string
		lineageTag: 073e38fe-ab5b-489f-a6e6-ff6744cf4e09
		summarizeBy: none
		sourceColumn: properties

		annotation SummarizationSetBy = Automatic

	column 'properties.networkSecurityGroup'
		dataType: string
		lineageTag: 8ff1ceae-7275-4140-97ff-2b5966d113ee
		summarizeBy: none
		sourceColumn: properties.networkSecurityGroup

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations'
		dataType: string
		lineageTag: 5b7294e2-2846-4688-91ba-a7de264bad07
		summarizeBy: none
		sourceColumn: properties.ipConfigurations

		annotation SummarizationSetBy = Automatic

	column 'properties.virtualMachine'
		dataType: string
		lineageTag: 6223842f-24da-46ce-8346-627044237497
		summarizeBy: none
		sourceColumn: properties.virtualMachine

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties'
		dataType: string
		lineageTag: 961de273-fb7c-4805-8df8-0f6a1ddb345b
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties

		annotation SummarizationSetBy = Automatic

	column 'properties.ipConfigurations.properties.publicIPAddress'
		dataType: string
		lineageTag: 0481ca01-dae9-474b-8233-501ab1bfe9ef
		summarizeBy: none
		sourceColumn: properties.ipConfigurations.properties.publicIPAddress

		annotation SummarizationSetBy = Automatic

	partition NetworkInterfaces = m
		mode: import
		queryGroup: 'Resource Graph'
		source =
				let
				  query = "
				    Resources
				    | where type =~ 'microsoft.network/networkinterfaces'
				    | extend
				      ['properties.provisioningState'] = properties.provisioningState,
				      ['properties.resourceGuid'] = properties.resourceGuid,
				      ['properties.enableAcceleratedNetworking'] = properties.enableAcceleratedNetworking,
				      ['properties.disableTcpStateTracking'] = properties.disableTcpStateTracking,
				      ['properties.vnetEncryptionSupported'] = properties.vnetEncryptionSupported,
				      ['properties.networkSecurityGroup'] = properties.networkSecurityGroup,
				      ['properties.ipConfigurations'] = properties.ipConfigurations,
				      ['properties.enableIPForwarding'] = properties.enableIPForwarding,
				      ['properties.tapConfigurations'] = properties.tapConfigurations,
				      ['properties.hostedWorkloads'] = properties.hostedWorkloads,
				      ['properties.allowPort25Out'] = properties.allowPort25Out,
				      ['properties.auxiliaryMode'] = properties.auxiliaryMode,
				      ['properties.dnsSettings'] = properties.dnsSettings,
				      ['properties.auxiliarySku'] = properties.auxiliarySku,
				      ['properties.macAddress'] = properties.macAddress,
				      ['properties.nicType'] = properties.nicType,
				      ['properties.primary'] = properties.primary,
				      ['properties.virtualMachine'] = properties.virtualMachine,
				      ['properties.virtualMachine.id'] = properties.virtualMachine.id
				    | mv-expand ['properties.ipConfigurations']
				    | extend
				      ['properties.ipConfigurations.type'] = properties.ipConfigurations.type,
				      ['properties.ipConfigurations.name'] = properties.ipConfigurations.name,
				      ['properties.ipConfigurations.properties'] = properties.ipConfigurations.properties,
				      ['properties.ipConfigurations.id'] = properties.ipConfigurations.id,
				      ['properties.ipConfigurations.etag'] = properties.ipConfigurations.etag,
				      ['properties.ipConfigurations.properties.provisioningState'] = properties.ipConfigurations.properties.provisioningState,
				      ['properties.ipConfigurations.properties.privateIPAddressVersion'] = properties.ipConfigurations.properties.privateIPAddressVersion,
				      ['properties.ipConfigurations.properties.privateIPAllocationMethod'] = properties.ipConfigurations.properties.privateIPAllocationMethod,
				      ['properties.ipConfigurations.properties.subnet'] = properties.ipConfigurations.properties.subnet,
				      ['properties.ipConfigurations.properties.privateIPAddress'] = properties.ipConfigurations.properties.privateIPAddress,
				      ['properties.ipConfigurations.properties.primary'] = properties.ipConfigurations.properties.primary,
				      ['properties.ipConfigurations.properties.publicIPAddress'] = properties.ipConfigurations.properties.publicIPAddress,
				      ['properties.ipConfigurations.properties.publicIPAddress.id'] = properties.ipConfigurations.properties.publicIPAddress.id,
				      ['properties.networkSecurityGroup.id'] = properties.networkSecurityGroup.id
				  " & ftk_DemoFilter(),
				  Source = AzureResourceGraph.Query(query, "Tenant", null, null, [resultTruncated = false]),
				  NullHandling =
				    if Table.HasColumns(Source, "Results") and Table.RowCount(Source) = 1 then
							#table(
								{ "id", "name", "properties.provisioningState", "properties.resourceGuid", "properties.enableAcceleratedNetworking", "properties.disableTcpStateTracking", "properties.vnetEncryptionSupported", "properties.networkSecurityGroup", "properties.ipConfigurations", "properties.enableIPForwarding", "properties.tapConfigurations", "properties.hostedWorkloads", "properties.allowPort25Out", "properties.auxiliaryMode", "properties.dnsSettings", "properties.auxiliarySku", "properties.macAddress", "properties.nicType", "properties.primary", "properties.virtualMachine", "properties.virtualMachine.id", "properties.ipConfigurations.type", "properties.ipConfigurations.name", "properties.ipConfigurations.properties", "properties.ipConfigurations.id", "properties.ipConfigurations.etag", "properties.ipConfigurations.properties.provisioningState", "properties.ipConfigurations.properties.privateIPAddressVersion", "properties.ipConfigurations.properties.privateIPAllocationMethod", "properties.ipConfigurations.properties.subnet", "properties.ipConfigurations.properties.privateIPAddress", "properties.ipConfigurations.properties.primary", "properties.ipConfigurations.properties.publicIPAddress", "properties.ipConfigurations.properties.publicIPAddress.id", "properties.networkSecurityGroup.id" },
								{}
							)
				    else Source
				in
				  NullHandling

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

